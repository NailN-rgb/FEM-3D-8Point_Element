function B = AssembleB3DElem(x, y, z)

% Form Funtions
% N1 = (1-x)(1-y)(1-z)
% N2 = (1+x)(1-y)(1-z)
% N3 = (1+x)(1-y)(1+z)
% N4 = (1-x)(1-y)(1+z)
% N5 = (1-x)(1+y)(1+z)
% N6 = (1+x)(1+y)(1+z)
% N7 = (1+x)(1+y)(1-z)
% N8 = (1-x)(1+y)(1-z)


B = 1/8 * [(1 - y) * (1 - z), 0, 0,...
           (1 - y) * (1 - z), 0, 0,...
          -(1 - y) * (1 + z), 0, 0,...
          -(1 - y) * (1 + z), 0, 0,...
           (1 + y) * (1 + z), 0, 0,...
           (1 + y) * (1 + z),0,0,...
          -(1 + y) * (1 - z),0,0,...
          -(1 + y) * (1 - z),0,0;
%x - derivative
           0,  (1 - x) * (1 - z), 0,...
           0, -(1 + x) * (1 - z), 0,...
           0,  (1 + x) * (1 + z), 0,...
           0, -(1 - x) * (1 + z), 0,...
           0, -(1 - x) * (1 + z), 0,...
           0,  (1 + x) * (1 + z), 0,...
           0, -(1 + x) * (1 - z),0,...
           0,  (1 - x) * (1 - z), 0;

           0, 0,  (1 - x) * (1 - y),...
           0, 0, -(1 + x) * (1 - y),...
           0, 0, -(1 + x) * (1 - y),...
           0, 0,  (1 - x) * (1 - y),...
           0, 0, -(1 - x) * (1 + y),...
           0, 0,  (1 + x) * (1 + y),...
           0, 0,  (1 + x) * (1 + y),...
           0, 0, -(1 - x) * (1 + y);

            (1 - x) * (1 - z),  (1 - y) * (1 - z), 0,...
           -(1 + x) * (1 - z),  (1 - y) * (1 - z), 0,...
            (1 + x) * (1 + z), -(1 - y) * (1 + z), 0,...
           -(1 - x) * (1 + z), -(1 - y) * (1 + z), 0,...
           -(1 - x) * (1 + z),  (1 + y) * (1 + z), 0,...
            (1 + x) * (1 + z),  (1 + y) * (1 + z), 0,...
           -(1 + x) * (1 - z), -(1 + y) * (1 - z), 0,...
            (1 - x) * (1 - z), -(1 + y) * (1 - z), 0;

           0,  (1 - x) * (1 - y),  (1 - x) * (1 - z),...
           0, -(1 + x) * (1 - y), -(1 + x) * (1 - z),...
           0, -(1 + x) * (1 - y),  (1 + x) * (1 + z),...
           0,  (1 - x) * (1 - y), -(1 - x) * (1 + z),...
           0, -(1 - x) * (1 + y), -(1 - x) * (1 + z),...
           0,  (1 + x) * (1 + y), (1 + x) * (1 + z),...
           0,  (1 + x) * (1 + y), -(1 + x) * (1 - z),...
           0, -(1 - x) * (1 + y),  (1 - x) * (1 - z);

            (1 - x) * (1 - y), 0,  (1 - y) * (1 - z),...
           -(1 + x) * (1 - y), 0,  (1 - y) * (1 - z),...
           -(1 + x) * (1 - y), 0, -(1 - y) * (1 + z),...
            (1 - x) * (1 - y), 0, -(1 - y) * (1 + z),...
           -(1 - x) * (1 + y), 0,  (1 + y) * (1 + z),...
            (1 + x) * (1 + y), 0,  (1 + y) * (1 + z),...
            (1 + x) * (1 + y), 0, -(1 + y) * (1 - z),...
           -(1 - x) * (1 + y), 0, -(1 + y) * (1 - z);
          ];

end